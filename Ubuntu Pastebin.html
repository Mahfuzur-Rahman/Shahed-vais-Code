<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0033)http://paste.ubuntu.com/12127200/ -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="./Ubuntu Pastebin_files/pastebin.css">
    <title>Ubuntu Pastebin</title>
</head>

    <body>
	<div id="outerColumnContainer" style="color: #000">
	      <div id="contentColumn">
		      <div class="inside">
	    <h1 id="title">Ubuntu Pastebin</h1>
	    

<h1>Paste from shahed's pastebin at Wed, 19 Aug 2015 16:36:15 +0000</h1>
<div class="paste">
<a class="pturl" href="http://paste.ubuntu.com/12127200/plain/">Download as text</a>
<div class="paste">
<table class="pastetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>   1
   2
   3
   4
   5
   6
   7
   8
   9
<span class="special">  10</span>
  11
  12
  13
  14
  15
  16
  17
  18
  19
<span class="special">  20</span>
  21
  22
  23
  24
  25
  26
  27
  28
  29
<span class="special">  30</span>
  31
  32
  33
  34
  35
  36
  37
  38
  39
<span class="special">  40</span>
  41
  42
  43
  44
  45
  46
  47
  48
  49
<span class="special">  50</span>
  51
  52
  53
  54
  55
  56
  57
  58
  59
<span class="special">  60</span>
  61
  62
  63
  64
  65
  66
  67
  68
  69
<span class="special">  70</span>
  71
  72
  73
  74
  75
  76
  77
  78
  79
<span class="special">  80</span>
  81
  82
  83
  84
  85
  86
  87
  88
  89
<span class="special">  90</span>
  91
  92
  93
  94
  95
  96
  97
  98
  99
<span class="special"> 100</span>
 101
 102
 103
 104
 105
 106
 107
 108
 109
<span class="special"> 110</span>
 111
 112
 113
 114
 115
 116
 117
 118
 119
<span class="special"> 120</span>
 121
 122
 123
 124
 125
 126
 127
 128
 129
<span class="special"> 130</span>
 131
 132
 133
 134
 135
 136
 137
 138
 139
<span class="special"> 140</span>
 141
 142
 143
 144
 145
 146
 147
 148
 149
<span class="special"> 150</span>
 151
 152
 153
 154
 155
 156
 157
 158
 159
<span class="special"> 160</span>
 161
 162
 163
 164
 165
 166
 167
 168
 169
<span class="special"> 170</span>
 171
 172
 173
 174
 175
 176
 177
 178
 179
<span class="special"> 180</span>
 181
 182
 183
 184
 185
 186
 187
 188
 189
<span class="special"> 190</span>
 191
 192
 193
 194
 195
 196
 197
 198
 199
<span class="special"> 200</span>
 201
 202
 203
 204
 205
 206
 207
 208
 209
<span class="special"> 210</span>
 211
 212
 213
 214
 215
 216
 217
 218
 219
<span class="special"> 220</span>
 221
 222
 223
 224
 225
 226
 227
 228
 229
<span class="special"> 230</span>
 231
 232
 233
 234
 235
 236
 237
 238
 239
<span class="special"> 240</span>
 241
 242
 243
 244
 245
 246
 247
 248
 249
<span class="special"> 250</span>
 251
 252
 253
 254
 255
 256
 257
 258
 259
<span class="special"> 260</span>
 261
 262
 263
 264
 265
 266
 267
 268
 269
<span class="special"> 270</span>
 271
 272
 273
 274
 275
 276
 277
 278
 279
<span class="special"> 280</span>
 281
 282
 283
 284
 285
 286
 287
 288
 289
<span class="special"> 290</span>
 291
 292
 293
 294
 295
 296
 297
 298
 299
<span class="special"> 300</span>
 301
 302
 303
 304
 305
 306
 307
 308
 309
<span class="special"> 310</span>
 311
 312
 313
 314
 315
 316
 317
 318
 319
<span class="special"> 320</span>
 321
 322
 323
 324
 325
 326
 327
 328
 329
<span class="special"> 330</span>
 331
 332
 333
 334
 335
 336
 337
 338
 339
<span class="special"> 340</span>
 341
 342
 343
 344
 345
 346
 347
 348
 349
<span class="special"> 350</span>
 351
 352
 353
 354
 355
 356
 357
 358
 359
<span class="special"> 360</span>
 361
 362
 363
 364
 365
 366
 367
 368
 369
<span class="special"> 370</span>
 371
 372
 373
 374
 375
 376
 377
 378
 379
<span class="special"> 380</span>
 381
 382
 383
 384
 385
 386
 387
 388
 389
<span class="special"> 390</span>
 391
 392
 393
 394
 395
 396
 397
 398
 399
<span class="special"> 400</span>
 401
 402
 403
 404
 405
 406
 407
 408
 409
<span class="special"> 410</span>
 411
 412
 413
 414
 415
 416
 417
 418
 419
<span class="special"> 420</span>
 421
 422
 423
 424
 425
 426
 427
 428
 429
<span class="special"> 430</span>
 431
 432
 433
 434
 435
 436
 437
 438
 439
<span class="special"> 440</span>
 441
 442
 443
 444
 445
 446
 447
 448
 449
<span class="special"> 450</span>
 451
 452
 453
 454
 455
 456
 457
 458
 459
<span class="special"> 460</span>
 461
 462
 463
 464
 465
 466
 467
 468
 469
<span class="special"> 470</span>
 471
 472
 473
 474
 475
 476
 477
 478
 479
<span class="special"> 480</span>
 481
 482
 483
 484
 485
 486
 487
 488
 489
<span class="special"> 490</span>
 491
 492
 493
 494
 495
 496
 497
 498
 499
<span class="special"> 500</span>
 501
 502
 503
 504
 505
 506
 507
 508
 509
<span class="special"> 510</span>
 511
 512
 513
 514
 515
 516
 517
 518
 519
<span class="special"> 520</span>
 521
 522
 523
 524
 525
 526
 527
 528
 529
<span class="special"> 530</span>
 531
 532
 533
 534
 535
 536
 537
 538
 539
<span class="special"> 540</span>
 541
 542
 543
 544
 545
 546
 547
 548
 549
<span class="special"> 550</span>
 551
 552
 553
 554
 555
 556
 557
 558
 559
<span class="special"> 560</span>
 561
 562
 563
 564
 565
 566
 567
 568
 569
<span class="special"> 570</span>
 571
 572
 573
 574
 575
 576
 577
 578
 579
<span class="special"> 580</span>
 581
 582
 583
 584
 585
 586
 587
 588
 589
<span class="special"> 590</span>
 591
 592
 593
 594
 595
 596
 597
 598
 599
<span class="special"> 600</span>
 601
 602
 603
 604
 605
 606
 607
 608
 609
<span class="special"> 610</span>
 611
 612
 613
 614
 615
 616
 617
 618
 619
<span class="special"> 620</span>
 621
 622
 623
 624
 625
 626
 627
 628
 629
<span class="special"> 630</span>
 631
 632
 633
 634
 635
 636
 637
 638
 639
<span class="special"> 640</span>
 641
 642
 643
 644
 645
 646
 647
 648
 649
<span class="special"> 650</span>
 651
 652
 653
 654
 655
 656
 657
 658
 659
<span class="special"> 660</span>
 661
 662
 663
 664
 665
 666
 667
 668
 669
<span class="special"> 670</span>
 671
 672
 673
 674
 675
 676
 677
 678
 679
<span class="special"> 680</span>
 681
 682
 683
 684
 685
 686
 687
 688
 689
<span class="special"> 690</span>
 691
 692
 693
 694
 695
 696
 697
 698
 699
<span class="special"> 700</span>
 701
 702
 703
 704
 705
 706
 707
 708
 709
<span class="special"> 710</span>
 711
 712
 713
 714
 715
 716
 717
 718
 719
<span class="special"> 720</span>
 721
 722
 723
 724
 725
 726
 727
 728
 729
<span class="special"> 730</span>
 731
 732
 733
 734
 735
 736
 737
 738
 739
<span class="special"> 740</span>
 741
 742
 743
 744
 745
 746
 747
 748
 749
<span class="special"> 750</span>
 751
 752
 753
 754
 755
 756
 757
 758
 759
<span class="special"> 760</span>
 761
 762
 763
 764
 765
 766
 767
 768
 769
<span class="special"> 770</span>
 771
 772
 773
 774
 775
 776
 777
 778
 779
<span class="special"> 780</span>
 781
 782
 783
 784
 785
 786
 787
 788
 789
<span class="special"> 790</span>
 791
 792
 793
 794
 795
 796
 797
 798
 799
<span class="special"> 800</span>
 801
 802
 803
 804
 805
 806
 807
 808
 809
<span class="special"> 810</span>
 811
 812
 813
 814
 815
 816
 817
 818
 819
<span class="special"> 820</span>
 821
 822
 823
 824
 825
 826
 827
 828
 829
<span class="special"> 830</span>
 831
 832
 833
 834
 835
 836
 837
 838
 839
<span class="special"> 840</span>
 841
 842
 843
 844
 845
 846
 847
 848
 849
<span class="special"> 850</span>
 851
 852
 853
 854
 855
 856
 857
 858
 859
<span class="special"> 860</span>
 861
 862
 863
 864
 865
 866
 867
 868
 869
<span class="special"> 870</span>
 871
 872
 873
 874
 875
 876
 877
 878
 879
<span class="special"> 880</span>
 881
 882
 883
 884
 885
 886
 887
 888
 889
<span class="special"> 890</span>
 891
 892
 893
 894
 895
 896
 897
 898
 899
<span class="special"> 900</span>
 901
 902
 903
 904
 905
 906
 907
 908
 909
<span class="special"> 910</span>
 911
 912
 913
 914
 915
 916
 917
 918
 919
<span class="special"> 920</span>
 921
 922
 923
 924
 925
 926
 927
 928
 929
<span class="special"> 930</span>
 931
 932
 933
 934
 935
 936
 937
 938
 939
<span class="special"> 940</span>
 941
 942
 943
 944
 945
 946
 947
 948
 949
<span class="special"> 950</span>
 951
 952
 953
 954
 955
 956
 957
 958
 959
<span class="special"> 960</span>
 961
 962
 963
 964
 965
 966
 967
 968
 969
<span class="special"> 970</span>
 971
 972
 973
 974
 975
 976
 977
 978
 979
<span class="special"> 980</span>
 981
 982
 983
 984
 985
 986
 987
 988
 989
<span class="special"> 990</span>
 991
 992
 993
 994
 995
 996
 997
 998
 999
<span class="special">1000</span>
1001
1002
1003
1004
1005
1006
1007
1008
1009
<span class="special">1010</span>
1011
1012
1013
1014
1015
1016
1017
1018
1019
<span class="special">1020</span>
1021
1022
1023
1024
1025
1026
1027
1028
1029
<span class="special">1030</span>
1031
1032
1033
1034
1035
1036
1037
1038
1039
<span class="special">1040</span>
1041
1042
1043
1044
1045
1046
1047
1048
1049
<span class="special">1050</span>
1051
1052
1053
1054
1055
1056
1057
1058
1059
<span class="special">1060</span>
1061
1062
1063
1064
1065
1066
1067
1068
1069
<span class="special">1070</span>
1071
1072
1073
1074
1075
1076
1077
1078
1079
<span class="special">1080</span>
1081
1082
1083
1084
1085
1086
1087
1088
1089
<span class="special">1090</span>
1091
1092
1093
1094
1095
1096
1097
1098
1099
<span class="special">1100</span>
1101
1102
1103
1104
1105
1106
1107
1108
1109
<span class="special">1110</span>
1111
1112
1113
1114
1115
1116
1117
1118
1119
<span class="special">1120</span>
1121
1122
1123
1124
1125
1126
1127
1128
1129
<span class="special">1130</span>
1131
1132
1133
1134
1135
1136
1137
1138
1139
<span class="special">1140</span>
1141
1142
1143
1144
1145
1146
1147
1148
1149
<span class="special">1150</span>
1151
1152
1153
1154
1155
1156
1157
1158
1159
<span class="special">1160</span>
1161
1162
1163
1164
1165
1166
1167
1168
1169
<span class="special">1170</span>
1171
1172
1173
1174
1175
1176
1177
1178
1179
<span class="special">1180</span>
1181
1182
1183
1184
1185
1186
1187
1188
1189
<span class="special">1190</span>
1191
1192
1193
1194
1195
1196
1197
1198
1199
<span class="special">1200</span>
1201
1202
1203
1204
1205
1206
1207
1208
1209
<span class="special">1210</span>
1211
1212
1213
1214
1215
1216
1217
1218
1219
<span class="special">1220</span>
1221
1222
1223
1224
1225
1226
1227
1228
1229
<span class="special">1230</span>
1231
1232
1233
1234
1235
1236
1237
1238
1239
<span class="special">1240</span>
1241
1242
1243
1244
1245
1246
1247
1248
1249
<span class="special">1250</span>
1251
1252
1253
1254
1255
1256
1257
1258
1259
<span class="special">1260</span>
1261
1262
1263
1264
1265
1266
1267
1268
1269
<span class="special">1270</span>
1271
1272
1273
1274
1275
1276
1277
1278
1279
<span class="special">1280</span>
1281
1282
1283
1284
1285
1286
1287
1288
1289
<span class="special">1290</span>
1291
1292
1293
1294
1295
1296
1297
1298
1299
<span class="special">1300</span>
1301
1302
1303
1304
1305
1306
1307
1308
1309
<span class="special">1310</span>
1311
1312
1313
1314
1315
1316
1317
1318
1319
<span class="special">1320</span>
1321
1322
1323
1324
1325
1326
1327
1328
1329
<span class="special">1330</span>
1331
1332
1333
1334
1335
1336
1337
1338
1339
<span class="special">1340</span>
1341
1342
1343
1344
1345
1346
1347
1348
1349
<span class="special">1350</span>
1351
1352
1353
1354
1355
1356
1357
1358
1359
<span class="special">1360</span>
1361
1362
1363
1364
1365
1366
1367
1368
1369
<span class="special">1370</span>
1371
1372
1373
1374
1375
1376
1377
1378
1379
<span class="special">1380</span>
1381
1382
1383
1384
1385
1386
1387
1388
1389
<span class="special">1390</span>
1391
1392
1393
1394
1395
1396
1397
1398
1399
<span class="special">1400</span>
1401
1402
1403
1404
1405
1406
1407
1408
1409
<span class="special">1410</span>
1411
1412
1413
1414
1415
1416
1417
1418
1419
<span class="special">1420</span>
1421
1422
1423
1424
1425
1426
1427
1428
1429
<span class="special">1430</span>
1431
1432
1433
1434
1435
1436
1437
1438
1439
<span class="special">1440</span>
1441
1442
1443
1444
1445
1446
1447
1448
1449
<span class="special">1450</span>
1451
1452
1453
1454
1455
1456
1457
1458
1459
<span class="special">1460</span>
1461
1462
1463
1464
1465
1466
1467
1468
1469
<span class="special">1470</span>
1471
1472
1473
1474
1475
1476
1477
1478
1479
<span class="special">1480</span>
1481
1482
1483
1484
1485
1486
1487
1488
1489
<span class="special">1490</span>
1491
1492
1493
1494
1495
1496
1497
1498
1499
<span class="special">1500</span>
1501
1502
1503
1504
1505
1506
1507
1508
1509
<span class="special">1510</span>
1511
1512
1513
1514
1515
1516
1517
1518
1519
<span class="special">1520</span>
1521
1522
1523
1524
1525
1526
1527
1528
1529
<span class="special">1530</span>
1531
1532
1533
1534
1535
1536
1537
1538
1539
<span class="special">1540</span>
1541
1542
1543
1544
1545
1546
1547
1548
1549
<span class="special">1550</span>
1551
1552
1553
1554
1555
1556
1557
1558
1559
<span class="special">1560</span>
1561
1562
1563
1564
1565
1566
1567
1568
1569
<span class="special">1570</span>
1571
1572
1573
1574
1575
1576
1577
1578
1579
<span class="special">1580</span>
1581
1582
1583
1584
1585
1586
1587
1588
1589
<span class="special">1590</span>
1591
1592
1593
1594
1595
1596
1597
1598
1599
<span class="special">1600</span>
1601
1602
1603
1604
1605
1606
1607
1608
1609
<span class="special">1610</span>
1611
1612
1613
1614
1615
1616
1617
1618
1619
<span class="special">1620</span>
1621
1622
1623
1624
1625
1626
1627
1628
1629
<span class="special">1630</span>
1631
1632
1633
1634
1635
1636
1637
1638
1639
<span class="special">1640</span>
1641
1642
1643
1644
1645
1646
1647
1648
1649
<span class="special">1650</span>
1651
1652
1653
1654
1655
1656
1657
1658
1659
<span class="special">1660</span>
1661
1662
1663
1664
1665
1666
1667
1668
1669
<span class="special">1670</span>
1671
1672
1673
1674
1675
1676
1677
1678
1679
<span class="special">1680</span>
1681
1682
1683
1684
1685
1686
1687
1688
1689
<span class="special">1690</span>
1691
1692
1693
1694
1695
1696
1697
1698
1699
<span class="special">1700</span>
1701
1702
1703
1704
1705
1706
1707
1708
1709
<span class="special">1710</span>
1711
1712
1713
1714
1715
1716
1717
1718
1719
<span class="special">1720</span>
1721
1722
1723
1724
1725
1726
1727
1728
1729
<span class="special">1730</span>
1731
1732
1733
1734
1735
1736
1737
1738
1739
<span class="special">1740</span>
1741
1742
1743
1744
1745
1746
1747
1748
1749
<span class="special">1750</span>
1751
1752
1753
1754
1755
1756
1757
1758
1759
<span class="special">1760</span>
1761
1762
1763
1764
1765
1766
1767
1768
1769
<span class="special">1770</span>
1771
1772
1773
1774
1775
1776
1777
1778
1779
<span class="special">1780</span>
1781
1782
1783
1784
1785
1786
1787
1788
1789
<span class="special">1790</span>
1791
1792
1793
1794
1795
1796
1797
1798
1799
<span class="special">1800</span>
1801
1802
1803
1804
1805
1806
1807
1808
1809
<span class="special">1810</span>
1811
1812
1813
1814
1815
1816
1817
1818
1819
<span class="special">1820</span>
1821
1822
1823
1824
1825
1826
1827
1828
1829
<span class="special">1830</span>
1831
1832
1833
1834
1835
1836
1837
1838
1839
<span class="special">1840</span>
1841
1842
1843
1844
1845
1846
1847
1848
1849
<span class="special">1850</span>
1851
1852
1853
1854
1855
1856
1857
1858
1859
<span class="special">1860</span>
1861
1862
1863
1864
1865
1866
1867
1868
1869
<span class="special">1870</span>
1871
1872
1873
1874
1875
1876
1877
1878
1879
<span class="special">1880</span>
1881
1882
1883
1884
1885
1886
1887
1888
1889
<span class="special">1890</span>
1891
1892
1893
1894
1895
1896
1897
1898
1899
<span class="special">1900</span>
1901
1902
1903
1904
1905
1906
1907
1908
1909
<span class="special">1910</span>
1911
1912
1913
1914
1915
1916
1917
1918
1919
<span class="special">1920</span>
1921
1922
1923
1924
1925
1926
1927
1928
1929
<span class="special">1930</span>
1931
1932
1933
1934
1935
1936
1937
1938
1939
<span class="special">1940</span>
1941
1942
1943
1944
1945
1946
1947
1948
1949
<span class="special">1950</span>
1951
1952
1953
1954
1955
1956
1957
1958
1959
<span class="special">1960</span>
1961
1962
1963
1964
1965
1966
1967
1968
1969
<span class="special">1970</span>
1971
1972
1973
1974
1975
1976
1977
1978
1979
<span class="special">1980</span>
1981
1982
1983
1984
1985
1986
1987
1988
1989
<span class="special">1990</span>
1991
1992
1993
1994
1995
1996
1997
1998
1999
<span class="special">2000</span>
2001
2002
2003
2004
2005
2006
2007
2008
2009
<span class="special">2010</span>
2011
2012
2013
2014
2015
2016
2017
2018
2019
<span class="special">2020</span>
2021
2022
2023
2024
2025
2026
2027
2028
2029
<span class="special">2030</span>
2031
2032
2033
2034
2035
2036
2037
2038
2039
<span class="special">2040</span>
2041
2042
2043
2044
2045
2046
2047
2048
2049
<span class="special">2050</span>
2051
2052
2053
2054
2055
2056
2057
2058
2059
<span class="special">2060</span>
2061
2062
2063
2064
2065
2066
2067
2068
2069
<span class="special">2070</span>
2071
2072
2073
2074
2075
2076
2077
2078
2079
<span class="special">2080</span>
2081
2082
2083
2084
2085
2086
2087
2088
2089
<span class="special">2090</span>
2091
2092
2093
2094
2095
2096
2097
2098
2099
<span class="special">2100</span>
2101
2102
2103
2104
2105
2106
2107
2108
2109
<span class="special">2110</span>
2111
2112
2113
2114
2115
2116
2117
2118
2119
<span class="special">2120</span>
2121
2122
2123
2124
2125
2126
2127
2128
2129
<span class="special">2130</span>
2131
2132
2133
2134
2135
2136
2137
2138
2139
<span class="special">2140</span></pre></div></td><td class="code"><div class="paste"><pre><span class="cp">/** Shahed Shahriar **/</span>

<span class="cp">#include &lt;bits/stdc++.h&gt;</span>

<span class="cp">#define rep(i,n) for(i=1;i&lt;=n;i++)</span>
<span class="cp">#define Rep(i,n) for(i=0;i&lt;n;i++)</span>
<span class="cp">#define For(i,a,b) for(i=a;i&lt;=b;i++)</span>

<span class="cp">#define pb(x) push_back(x)</span>
<span class="cp">#define sz(x) x.size()</span>

<span class="cp">#define mem(ara,val) memset(ara,val,sizeof(ara))</span>
<span class="cp">#define eps 1e-9</span>

<span class="cp">#define si(x) scanf("%d",&amp;x)</span>
<span class="cp">#define sii(x,y) scanf("%d %d",&amp;x,&amp;y)</span>
<span class="cp">#define siii(x,y,z) scanf("%d %d %d",&amp;x,&amp;y,&amp;z)</span>
<span class="cp">#define sl(x) scanf("%lld",&amp;x)</span>
<span class="cp">#define sll(x,y) scanf("%lld %lld",&amp;x,&amp;y)</span>
<span class="cp">#define slll(x,y,z) scanf("%lld %lld %lld",&amp;x,&amp;y,&amp;z)</span>
<span class="cp">#define ss(ch) scanf("%s",ch)</span>
<span class="cp">#define pi(x) printf("%d",x)</span>
<span class="cp">#define pii(x,y) printf("%d %d",x,y)</span>
<span class="cp">#define piii(x,y,z) printf("%d %d %d",x,y,z)</span>
<span class="cp">#define pl(x) printf("%lld",x)</span>
<span class="cp">#define pll(x,y) printf("%lld %lld",x,y)</span>
<span class="cp">#define plll(x,y,z) printf("%lld %lld %lld",x,y,z)</span>
<span class="cp">#define ps(ch) printf("%s",ch)</span>
<span class="cp">#define Afridi 0</span>
<span class="cp">#define NL printf("\n")</span>
<span class="cp">#define debug(x) printf("wow  %d !!\n",x)</span>
<span class="cp">#define Max 1000000</span>
<span class="cp">#define INF INT_MAX</span>
<span class="cp">#define mod 1000000007</span>

<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ULL</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">LL</span> <span class="n">bigmod</span><span class="p">(</span><span class="n">LL</span> <span class="n">b</span><span class="p">,</span><span class="n">LL</span> <span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">my</span> <span class="o">=</span> <span class="n">bigmod</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">p</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">my</span><span class="o">*=</span><span class="n">my</span><span class="p">;</span><span class="n">my</span><span class="o">%=</span><span class="n">mod</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">p</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span><span class="n">my</span><span class="o">*=</span><span class="n">b</span><span class="p">,</span><span class="n">my</span><span class="o">%=</span><span class="n">mod</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">my</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">setb</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span><span class="k">return</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span><span class="p">);}</span>
<span class="kt">int</span> <span class="n">resb</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span><span class="k">return</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span><span class="p">);}</span>
<span class="kt">bool</span> <span class="n">checkb</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span><span class="k">return</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span><span class="p">));}</span>


<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>










<span class="cm">/** Articulation Point**/</span>

<span class="kt">void</span> <span class="n">AP</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">tm</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">child</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">size</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">child</span><span class="o">++</span><span class="p">;</span>
            <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
            <span class="n">AP</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
            <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">child</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="n">ap</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="n">ap</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="n">bridge</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="o">!=</span> <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>









<span class="cm">/** Bellman Ford **/</span>

<span class="kt">void</span> <span class="n">bellman</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
    <span class="n">dis</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">e</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">ed</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">u</span><span class="p">;</span>
            <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">ed</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
            <span class="n">LL</span> <span class="n">w</span> <span class="o">=</span> <span class="n">ed</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span> <span class="o">&amp;&amp;</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+</span><span class="n">w</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">e</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">ed</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">u</span><span class="p">;</span>
        <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">ed</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
        <span class="n">LL</span> <span class="n">w</span> <span class="o">=</span> <span class="n">ed</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span> <span class="o">&amp;&amp;</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+</span><span class="n">w</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="c1">///cycle detected;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>









<span class="cm">/** BFS **/</span>

<span class="c1">///computing cost of every node from source</span>

<span class="kt">void</span> <span class="n">bfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">visit</span><span class="p">));</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">cost</span><span class="p">));</span>
    <span class="n">queue</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">cost</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">v</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span> <span class="n">v</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">cost</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">cost</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
            <span class="p">}</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>









<span class="cm">/** BIT **/</span>

<span class="n">LL</span> <span class="n">read</span><span class="p">(</span><span class="n">LL</span> <span class="n">ind</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ind</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">sum</span> <span class="o">+=</span> <span class="n">tree</span><span class="p">[</span><span class="n">ind</span><span class="p">];</span>
        <span class="n">ind</span> <span class="o">-=</span> <span class="p">(</span><span class="n">ind</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">ind</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">sum</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">LL</span> <span class="n">ind</span><span class="p">,</span><span class="n">LL</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ind</span> <span class="o">&lt;=</span> <span class="n">mx</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">tree</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span><span class="p">;</span>
        <span class="n">ind</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ind</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">ind</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">LL</span> <span class="n">readsingle</span><span class="p">(</span><span class="n">LL</span> <span class="n">ind</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="n">ind</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ind</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">z</span> <span class="o">=</span> <span class="n">ind</span> <span class="o">-</span> <span class="p">(</span><span class="n">ind</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">ind</span><span class="p">);</span>
        <span class="n">ind</span><span class="o">--</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">ind</span> <span class="o">!=</span> <span class="n">z</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">sum</span> <span class="o">-=</span> <span class="n">tree</span><span class="p">[</span><span class="n">ind</span><span class="p">];</span>
            <span class="n">ind</span> <span class="o">-=</span> <span class="p">(</span><span class="n">idn</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">ind</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">sum</span><span class="p">;</span>
<span class="p">}</span>










<span class="cm">/** Bitmask **/</span>

<span class="kt">int</span> <span class="n">setb</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">resb</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">check</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span><span class="p">));</span>
<span class="p">}</span>









<span class="cm">/** Die Throwing **/</span>

<span class="cm">/** m sided dice,n number of die,x ispossible**/</span>

<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">x</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">x</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;=</span><span class="n">m</span> <span class="o">&amp;&amp;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">j</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>











<span class="cm">/** Dijkstra **/</span>

<span class="n">LL</span> <span class="n">dijkstra</span><span class="p">(</span><span class="n">LL</span> <span class="n">s</span><span class="p">,</span><span class="n">LL</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">d</span><span class="p">));</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">par</span><span class="p">));</span>
    <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">priority_queue</span> <span class="o">&lt;</span><span class="n">node</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span> <span class="n">node</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">);</span>
    <span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">node</span> <span class="n">nod</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
        <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">nod</span><span class="p">.</span><span class="n">u</span><span class="p">;</span>
        <span class="n">LL</span> <span class="n">c</span> <span class="o">=</span> <span class="n">nod</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="k">return</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="k">for</span><span class="p">(</span><span class="n">LL</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">cost</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">cost</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
                <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span> <span class="n">node</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="c1">/// if unreachable</span>
<span class="p">}</span>









<span class="cm">/** Disjoint set **/</span>

<span class="n">LL</span> <span class="n">Find</span><span class="p">(</span><span class="n">LL</span> <span class="n">r</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">r</span> <span class="o">==</span> <span class="n">par</span><span class="p">[</span><span class="n">r</span><span class="p">])</span><span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">par</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">Find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">r</span><span class="p">]);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Union</span><span class="p">(</span><span class="n">LL</span> <span class="n">x</span><span class="p">,</span><span class="n">LL</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">Find</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">FInd</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="c1">///cycle detected</span>
    <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">///initially everybody is parent of his own</span>











<span class="cm">/** Extended Euclid **/</span>

<span class="k">struct</span> <span class="n">node</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">make</span><span class="p">(</span><span class="n">LL</span> <span class="n">a</span><span class="p">,</span><span class="n">LL</span> <span class="n">b</span><span class="p">,</span><span class="n">LL</span> <span class="n">c</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">node</span> <span class="n">xgcd</span><span class="p">(</span><span class="n">LL</span> <span class="n">a</span><span class="p">,</span><span class="n">LL</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">node</span> <span class="n">ans</span><span class="p">;</span>
        <span class="n">ans</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">node</span> <span class="n">ans</span><span class="p">,</span><span class="n">tmp</span><span class="p">;</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">xgcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">);</span>
    <span class="n">ans</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">tmp</span><span class="p">.</span><span class="n">y</span><span class="p">,(</span><span class="n">tmp</span><span class="p">.</span><span class="n">g</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">tmp</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>













<span class="cm">/** Floyed Warshall **/</span>

<span class="kt">void</span> <span class="n">floyed</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">dis</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="p">{</span>
                    <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>










<span class="cp">/** Gauss **/</span>

<span class="cp">#include &lt;bits/stdc++.h&gt;</span>
<span class="cp">#define Max 105</span>
<span class="cp">#define mem(ara,val) memset(ara,val,sizeof(ara))</span>
<span class="cp">#define eps 1e-10</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">double</span> <span class="n">a</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>

<span class="kt">double</span> <span class="n">Gauss</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">irow</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">icol</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">ipiv</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">irow</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">icol</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">ipiv</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">det</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">pj</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pk</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">ipiv</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">ipiv</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="p">{</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">pj</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]))</span>
                        <span class="p">{</span>
                            <span class="n">pj</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
                            <span class="n">pk</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Matrix is singular."</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">ipiv</span><span class="p">[</span><span class="n">pk</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">pj</span> <span class="o">!=</span> <span class="n">pk</span><span class="p">)</span> <span class="n">det</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
        <span class="n">irow</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pj</span><span class="p">;</span>
        <span class="n">icol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pk</span><span class="p">;</span>

        <span class="kt">double</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">a</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">pk</span><span class="p">];</span>
        <span class="n">det</span> <span class="o">*=</span> <span class="n">a</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">pk</span><span class="p">];</span>
        <span class="n">a</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">p</span><span class="o">++</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="o">*=</span> <span class="n">c</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">p</span><span class="o">++</span><span class="p">)</span> <span class="n">b</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="o">*=</span> <span class="n">c</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">p</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="n">pk</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">pk</span><span class="p">];</span>
                <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">q</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">q</span><span class="o">++</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">q</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">q</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">q</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">q</span><span class="o">++</span><span class="p">)</span> <span class="n">b</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">q</span><span class="p">]</span> <span class="o">-=</span> <span class="n">b</span><span class="p">[</span><span class="n">pk</span><span class="p">][</span><span class="n">q</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">p</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">irow</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">!=</span> <span class="n">icol</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">irow</span><span class="p">[</span><span class="n">p</span><span class="p">]],</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">icol</span><span class="p">[</span><span class="n">p</span><span class="p">]]);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">det</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},{</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">}</span> <span class="p">};</span>
    <span class="kt">double</span> <span class="n">B</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},{</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">},{</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">},{</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">}</span> <span class="p">};</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">Gauss</span><span class="p">();</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"det %lf</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">ans</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">printf</span><span class="p">(</span><span class="s">"%lf "</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">printf</span><span class="p">(</span><span class="s">"%lf "</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>











<span class="cm">/** HLD **/</span>

<span class="n">vector</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">par</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span><span class="c1">///</span>
<span class="kt">bool</span> <span class="n">visit</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span><span class="c1">///</span>
<span class="kt">int</span> <span class="n">child</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">special</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span><span class="n">i</span><span class="p">,</span><span class="n">mx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">child</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">mx</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">mx</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">child</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">child</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">child</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="n">special</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">Max</span><span class="p">]</span><span class="cm">/**/</span><span class="p">,</span><span class="n">tail</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">dis</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">path</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">chaindx</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">cn</span><span class="cm">/**/</span><span class="p">,</span><span class="n">sand</span><span class="cm">/**/</span><span class="p">;</span>
<span class="kt">void</span> <span class="n">HLD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">sand</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="n">head</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="n">sand</span><span class="p">;</span>
    <span class="n">tail</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span> <span class="o">=</span> <span class="n">sand</span><span class="p">;</span>
    <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">sand</span><span class="p">;</span>
    <span class="n">path</span><span class="p">[</span><span class="n">sand</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
    <span class="n">chaindx</span><span class="p">[</span><span class="n">sand</span><span class="p">]</span> <span class="o">=</span> <span class="n">cn</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">special</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="n">HLD</span><span class="p">(</span><span class="n">special</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span><span class="n">i</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">||</span> <span class="n">v</span> <span class="o">==</span> <span class="n">special</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">cn</span><span class="o">++</span><span class="p">;</span>
        <span class="n">HLD</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>











<span class="cm">/** KMP **/</span>

<span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">lps</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="kt">void</span> <span class="n">prework</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">lps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">l</span> <span class="o">=</span> <span class="n">patlen</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">len</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">len</span><span class="o">++</span><span class="p">;</span>
            <span class="n">lps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
            <span class="n">i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">lps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">i</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">len</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">kmp</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">l1</span> <span class="o">=</span> <span class="n">textlen</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">patlen</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">l1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">i</span><span class="o">++</span><span class="p">;</span>
            <span class="n">j</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">l2</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ans</span><span class="p">[</span><span class="n">ind</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">;</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
            <span class="k">else</span> <span class="n">j</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>












<span class="cm">/** LCA **/</span>

<span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">,</span><span class="n">LL</span> <span class="n">dept</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">L</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">dept</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span><span class="n">i</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">dept</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">init</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">col</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)(</span><span class="n">log10</span><span class="p">((</span><span class="kt">double</span><span class="p">)(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">log10</span><span class="p">(</span><span class="mf">2.0</span><span class="p">));</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">dfs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">col</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span> <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">LL</span> <span class="n">query</span><span class="p">(</span><span class="n">LL</span> <span class="n">a</span><span class="p">,</span><span class="n">LL</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">[</span><span class="n">b</span><span class="p">])</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">col</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">L</span><span class="p">[</span><span class="n">b</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span><span class="k">return</span> <span class="n">a</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">col</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">par</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">par</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">par</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>












<span class="cm">/** LCS **/</span>

<span class="n">LL</span> <span class="n">LCS</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">dp</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="p">];</span>
<span class="p">}</span>














<span class="cm">/** LIS **/</span>

<span class="n">LL</span> <span class="n">LIS</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ara</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">LL</span> <span class="n">mx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">mx</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">mx</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">mx</span><span class="p">;</span>
<span class="p">}</span>













<span class="cm">/** LIS Better **/</span>

<span class="n">LL</span> <span class="n">LIS</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">;</span>
    <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ara</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">[</span><span class="n">len</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">len</span><span class="o">++</span><span class="p">;</span>
            <span class="n">c</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">k</span> <span class="o">=</span> <span class="n">bin</span><span class="p">();</span> <span class="cm">/*we want to find k so that c[k-1] &lt; ara[i] &lt;= c[k]*/</span>
            <span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
















<span class="cm">/** LPS **/</span>

<span class="n">LL</span> <span class="n">LPS</span><span class="p">(</span><span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">LL</span> <span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">str</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span><span class="k">return</span> <span class="mi">2</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">str</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="k">return</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">LPS</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">max</span><span class="p">(</span> <span class="n">LPS</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">LPS</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>















<span class="cm">/** Mat expo **/</span>

<span class="k">struct</span> <span class="n">Mat</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">m</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">6</span><span class="p">];</span>
    <span class="kt">void</span> <span class="n">makemod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
        <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">%=</span> <span class="n">mod</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">Mat</span> <span class="n">mul</span><span class="p">(</span><span class="n">Mat</span> <span class="n">A</span><span class="p">,</span><span class="n">Mat</span> <span class="n">B</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Mat</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;=</span><span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">tmp</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;=</span><span class="mi">4</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">tmp</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">A</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
                <span class="n">tmp</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">%=</span> <span class="n">mod</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">tmp</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Mat</span> <span class="n">bigmod</span><span class="p">(</span><span class="n">LL</span> <span class="n">pow</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pow</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">M</span><span class="p">;</span>
    <span class="n">Mat</span> <span class="n">my</span> <span class="o">=</span> <span class="n">bigmod</span><span class="p">(</span><span class="n">pow</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">my</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">my</span><span class="p">,</span><span class="n">my</span><span class="p">);</span>
    <span class="n">my</span><span class="p">.</span><span class="n">makemod</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pow</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">my</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">my</span><span class="p">);</span>
        <span class="n">my</span><span class="p">.</span><span class="n">makemod</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">my</span><span class="p">;</span>
<span class="p">}</span>














<span class="cm">/** MaxFlow **/</span>

<span class="kt">int</span> <span class="n">g</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">],</span><span class="n">rg</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">par</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">n</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">bfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">bool</span> <span class="n">visit</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">par</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

    <span class="n">queue</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span><span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">rg</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">flow</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">mx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span><span class="n">bfs</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">path</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>

        <span class="k">for</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">t</span><span class="p">;</span> <span class="n">v</span><span class="o">!=</span><span class="n">s</span><span class="p">;</span> <span class="n">v</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">rg</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]);</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">t</span><span class="p">;</span> <span class="n">v</span><span class="o">!=</span><span class="n">s</span><span class="p">;</span> <span class="n">v</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
            <span class="n">rg</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">-=</span><span class="n">path</span><span class="p">;</span>
            <span class="n">rg</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">path</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">mx</span><span class="o">+=</span><span class="n">path</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">mx</span><span class="p">;</span>
<span class="p">}</span>













<span class="cp">/** Maximum Matching **/</span>

<span class="cp">#include &lt;bits/stdc++.h&gt;</span>

<span class="cp">#define rep(i,n) for(i=1;i&lt;=n;i++)</span>
<span class="cp">#define Rep(i,n) for(i=0;i&lt;n;i++)</span>
<span class="cp">#define For(i,a,b) for(i=a;i&lt;=b;i++)</span>

<span class="cp">#define pb(x) push_back(x)</span>
<span class="cp">#define sz(x) x.size()</span>

<span class="cp">#define mem(ara,val) memset(ara,val,sizeof(ara))</span>
<span class="cp">#define eps 1e-9</span>

<span class="cp">#define si(x) scanf("%d",&amp;x)</span>
<span class="cp">#define sii(x,y) scanf("%d %d",&amp;x,&amp;y)</span>
<span class="cp">#define siii(x,y,z) scanf("%d %d %d",&amp;x,&amp;y,&amp;z)</span>
<span class="cp">#define sl(x) scanf("%lld",&amp;x)</span>
<span class="cp">#define sll(x,y) scanf("%lld %lld",&amp;x,&amp;y)</span>
<span class="cp">#define slll(x,y,z) scanf("%lld %lld %lld",&amp;x,&amp;y,&amp;z)</span>
<span class="cp">#define ss(ch) scanf("%s",ch)</span>
<span class="cp">#define pi(x) printf("%d",x)</span>
<span class="cp">#define pii(x,y) printf("%d %d",x,y)</span>
<span class="cp">#define piii(x,y,z) printf("%d %d %d",x,y,z)</span>
<span class="cp">#define pl(x) printf("%lld",x)</span>
<span class="cp">#define pll(x,y) printf("%lld %lld",x,y)</span>
<span class="cp">#define plll(x,y,z) printf("%lld %lld %lld",x,y,z)</span>
<span class="cp">#define ps(ch) printf("%s",ch)</span>
<span class="cp">#define Afridi 0</span>
<span class="cp">#define NL printf("\n")</span>
<span class="cp">#define SP printf(" ")</span>
<span class="cp">#define loj(x) printf("Case %d:",x)</span>
<span class="cp">#define Loj(x) printf("Case %lld:",x)</span>
<span class="cp">#define debug(str,x) cout &lt;&lt; str &lt;&lt; " " &lt;&lt; x &lt;&lt; endl;</span>
<span class="cp">#define Max 1005</span>
<span class="cp">#define INF INT_MAX</span>

<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ULL</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">LL</span> <span class="n">Left</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">Right</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">visit</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="kt">bool</span> <span class="n">dfs</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span><span class="n">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Right</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Left</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
            <span class="n">Right</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">dfs</span><span class="p">(</span><span class="n">Right</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Left</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
            <span class="n">Right</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">LL</span> <span class="n">bpm</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">Left</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">Right</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">mem</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">Left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">LL</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">cnt</span><span class="p">;</span>
<span class="p">}</span>













<span class="cp">/** Minimum Cost Maximum Flow **/</span>

<span class="cp">#include &lt;bits/stdc++.h&gt;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="cp">#define Pot(u,v) (d[u] + pi[u] - pi[v])</span>
<span class="n">LL</span> <span class="n">cap</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">],</span><span class="n">cost</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">fnet</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">],</span><span class="n">adj</span><span class="p">[</span><span class="n">Max</span><span class="p">][</span><span class="n">Max</span><span class="p">],</span> <span class="n">deg</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">par</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">pi</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">fcost</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">dijkstra</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">,</span> <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">par</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">bestD</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">bestD</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">bestD</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span> <span class="o">=</span> <span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">bestD</span> <span class="o">==</span> <span class="n">INF</span> <span class="p">)</span> <span class="k">break</span><span class="p">;</span>

        <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">deg</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">continue</span><span class="p">;</span>

            <span class="k">if</span><span class="p">(</span> <span class="n">fnet</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Pot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="n">cost</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pot</span><span class="p">(</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="p">)</span> <span class="o">-</span> <span class="n">cost</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">u</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">fnet</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">cap</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Pot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">cost</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">cost</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">INF</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">par</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">LL</span> <span class="n">mcmf3</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">deg</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">cap</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">||</span> <span class="n">cap</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">mem</span><span class="p">(</span><span class="n">fnet</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">flow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">fcost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span> <span class="n">dijkstra</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">bot</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span> <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">];</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">s</span><span class="p">;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="p">]</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">bot</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span><span class="n">fnet</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">?</span> <span class="n">fnet</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">:</span> <span class="p">(</span> <span class="n">cap</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnet</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="p">));</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span> <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">];</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">s</span><span class="p">;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="p">]</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">fnet</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">fnet</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">-=</span> <span class="n">bot</span><span class="p">;</span>
                <span class="n">fcost</span> <span class="o">-=</span> <span class="n">bot</span> <span class="o">*</span> <span class="n">cost</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">fnet</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">+=</span> <span class="n">bot</span><span class="p">;</span>
                <span class="n">fcost</span> <span class="o">+=</span> <span class="n">bot</span> <span class="o">*</span> <span class="n">cost</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">flow</span> <span class="o">+=</span> <span class="n">bot</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">flow</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">///----------------- EXAMPLE USAGE -----------------</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">numV</span><span class="p">;</span>
    <span class="c1">///  while ( cin &gt;&gt; numV &amp;&amp; numV ) {</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">cap</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="n">mem</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cp</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">t</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="n">cp</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">cost</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span> <span class="c1">/// cost[b][a] = c;</span>
        <span class="n">cap</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">cp</span><span class="p">;</span> <span class="c1">/// cap[b][a] = cp;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">flow</span> <span class="o">=</span> <span class="n">mcmf3</span><span class="p">();</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"flow: "</span> <span class="o">&lt;&lt;</span> <span class="n">flow</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"cost: "</span> <span class="o">&lt;&lt;</span> <span class="n">fcost</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>















<span class="cm">/** Mobius **/</span>

<span class="kt">bool</span> <span class="n">check</span><span class="p">(</span><span class="n">LL</span> <span class="n">x</span><span class="p">,</span><span class="n">LL</span> <span class="n">d</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">sieve</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">10000000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">good</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">pra</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">10000000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">pra</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;=</span><span class="mi">10000000</span><span class="p">;</span> <span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">divcnt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">!=</span><span class="n">j</span><span class="p">)</span><span class="n">pra</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">))</span><span class="n">good</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">divcnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">good</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">good</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>













<span class="cm">/** Mod of string **/</span>

<span class="n">LL</span> <span class="n">mod</span><span class="p">(</span><span class="kt">char</span> <span class="n">x</span><span class="p">[],</span><span class="n">LL</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">tot</span><span class="p">,</span><span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">tot</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">tot</span> <span class="o">%</span> <span class="n">a</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">m</span><span class="p">;</span>
<span class="p">}</span>















<span class="cm">/** Operator overload **/</span>

<span class="k">struct</span> <span class="n">node</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">u</span><span class="p">,</span><span class="n">w</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">node</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">)</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>














<span class="cm">/** Postfix and Result **/</span>

<span class="k">struct</span> <span class="n">info</span>
<span class="p">{</span>
    <span class="kt">bool</span> <span class="n">opt</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">val</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">make</span><span class="p">(</span><span class="kt">bool</span> <span class="n">x</span><span class="p">,</span><span class="kt">char</span> <span class="n">y</span><span class="p">,</span><span class="n">LL</span> <span class="n">z</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span><span class="n">c</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span><span class="n">val</span> <span class="o">=</span> <span class="n">z</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="n">info</span> <span class="n">ara</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">L</span><span class="p">;</span>
<span class="n">stack</span> <span class="o">&lt;</span><span class="n">info</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="n">info</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>

<span class="n">LL</span> <span class="n">precedence</span><span class="p">(</span><span class="n">info</span> <span class="n">A</span><span class="p">,</span><span class="n">info</span> <span class="n">B</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'+'</span> <span class="o">||</span> <span class="n">A</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'-'</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'+'</span> <span class="o">||</span> <span class="n">B</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'-'</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'*'</span> <span class="o">||</span> <span class="n">B</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'/'</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">postfix</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="n">q</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="n">info</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="n">tmp</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sc">')'</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">ara</span><span class="p">[</span><span class="n">L</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="n">tmp</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sc">'('</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">LL</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">L</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">opt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">q</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'('</span><span class="p">)</span><span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c</span> <span class="o">==</span> <span class="sc">')'</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'('</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
                    <span class="n">q</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
                <span class="p">{</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'('</span> <span class="o">||</span> <span class="n">tmp</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">')'</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
                    <span class="n">LL</span> <span class="n">my</span> <span class="o">=</span> <span class="n">precedence</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">tmp</span><span class="p">);</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">my</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">q</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
                        <span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ara</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">LL</span> <span class="n">result</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">info</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="n">i</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">info</span> <span class="n">my</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">my</span><span class="p">.</span><span class="n">opt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">my</span><span class="p">);</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">info</span> <span class="n">A</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span><span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="n">info</span> <span class="n">B</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span><span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="n">LL</span> <span class="n">val</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">my</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'+'</span><span class="p">)</span><span class="n">val</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">A</span><span class="p">.</span><span class="n">val</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">my</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'-'</span><span class="p">)</span><span class="n">val</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">val</span> <span class="o">-</span> <span class="n">A</span><span class="p">.</span><span class="n">val</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">my</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'*'</span><span class="p">)</span><span class="n">val</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">val</span> <span class="o">*</span> <span class="n">A</span><span class="p">.</span><span class="n">val</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">my</span><span class="p">.</span><span class="n">c</span> <span class="o">==</span> <span class="sc">'/'</span><span class="p">)</span><span class="n">val</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">val</span> <span class="o">/</span> <span class="n">A</span><span class="p">.</span><span class="n">val</span><span class="p">;</span>
            <span class="n">tmp</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">val</span><span class="p">);</span>
            <span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">val</span><span class="p">;</span>
<span class="p">}</span>















<span class="cm">/** Sieve **/</span>

<span class="kt">void</span> <span class="n">sieve</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">pra</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">100000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">pra</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;=</span><span class="mi">100000</span><span class="p">;</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="n">pra</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>














<span class="cp">/** String x String **/</span>

<span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;string.h&gt;</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">c</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="mi">2000</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="mi">2000</span><span class="p">],</span><span class="n">ch</span><span class="p">[</span><span class="mi">2000</span><span class="p">],</span><span class="n">num</span><span class="p">[</span><span class="mi">4000</span><span class="p">];</span>
    <span class="k">while</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%s %s"</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">!=</span><span class="n">EOF</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">ch</span><span class="p">));</span>
        <span class="n">len</span><span class="o">=</span><span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&lt;</span><span class="n">strlen</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">len</span><span class="o">=</span><span class="n">strlen</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
            <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="o">-</span><span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">ch</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">'0'</span><span class="p">;</span>
            <span class="n">strcat</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="n">a</span><span class="p">);</span>
            <span class="n">strcpy</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">ch</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="o">-</span><span class="n">strlen</span><span class="p">(</span><span class="n">b</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">ch</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">'0'</span><span class="p">;</span>
            <span class="n">strcat</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
            <span class="n">strcpy</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">ch</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">ch</span><span class="p">));</span>
        <span class="k">for</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">len</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="n">k</span><span class="o">--</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">f</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span> <span class="n">f</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">s</span><span class="o">+=</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">f</span><span class="p">]</span><span class="o">-</span><span class="mi">48</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="n">f</span><span class="p">]</span><span class="o">-</span><span class="mi">48</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">s</span><span class="o">+=</span><span class="n">h</span><span class="p">;</span>
            <span class="n">ch</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">]</span><span class="o">=</span><span class="n">s</span><span class="o">%</span><span class="mi">10</span><span class="o">+</span><span class="mi">48</span><span class="p">;</span>
            <span class="n">h</span><span class="o">=</span><span class="n">s</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">x</span><span class="p">;</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">,</span><span class="n">k</span><span class="o">--</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">f</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span> <span class="n">f</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">s</span><span class="o">+=</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">-</span><span class="mi">48</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">f</span><span class="p">]</span><span class="o">-</span><span class="mi">48</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">s</span><span class="o">+=</span><span class="n">h</span><span class="p">;</span>
            <span class="n">ch</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">]</span><span class="o">=</span><span class="n">s</span><span class="o">%</span><span class="mi">10</span><span class="o">+</span><span class="mi">48</span><span class="p">;</span>
            <span class="n">h</span><span class="o">=</span><span class="n">s</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">h</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ch</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">%</span><span class="mi">10</span><span class="o">+</span><span class="mi">48</span><span class="p">;</span>
            <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">num</span><span class="p">));</span>
        <span class="k">for</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="sc">'0'</span> <span class="o">&amp;&amp;</span> <span class="n">c</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">num</span><span class="p">[</span><span class="n">h</span><span class="o">++</span><span class="p">]</span><span class="o">=</span><span class="n">ch</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">c</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="n">printf</span><span class="p">(</span><span class="s">"0</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">else</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">num</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>











<span class="cm">/** SCC **/</span>

<span class="n">vector</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">ug</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">sc</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">cg</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">visit</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">stack</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
<span class="n">LL</span> <span class="n">idx</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">codx</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">,</span><span class="n">LL</span> <span class="n">f</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">len</span><span class="p">,</span><span class="n">i</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">f</span><span class="p">)</span><span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="k">else</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">ug</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">f</span><span class="p">)</span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">else</span> <span class="n">v</span> <span class="o">=</span> <span class="n">ug</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">f</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">f</span><span class="p">)</span><span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">sc</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
        <span class="n">codx</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">go</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">,</span><span class="n">LL</span> <span class="n">c</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span><span class="n">i</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">codx</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="n">c</span><span class="p">)</span><span class="n">cg</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">codx</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">buildGraph</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="n">sort</span><span class="p">(</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">());</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="n">go</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">///compress</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="n">sort</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">());</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">vector</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">tmp</span><span class="p">;</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">LL</span> <span class="n">prev</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">prev</span><span class="p">)</span><span class="n">tmp</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
        <span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>



<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="n">sll</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">sll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
        <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
        <span class="n">ug</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
        <span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">idx</span><span class="o">++</span><span class="p">;</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">buildGraph</span><span class="p">();</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">j</span><span class="p">;</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span><span class="n">printf</span><span class="p">(</span><span class="s">"%lld "</span><span class="p">,</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="n">NL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">j</span><span class="p">;</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span><span class="n">printf</span><span class="p">(</span><span class="s">"%lld -&gt; %lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>












<span class="cm">/** Suffix Array **/</span>

<span class="k">struct</span> <span class="n">node</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">ind</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span> <span class="k">const</span> <span class="n">node</span><span class="o">&amp;</span> <span class="n">p</span> <span class="p">)</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="n">node</span> <span class="n">L</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">P</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="n">Max</span><span class="p">],</span><span class="n">D</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">len</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="n">LL</span> <span class="n">LCP</span><span class="p">(</span><span class="n">LL</span> <span class="n">x</span><span class="p">,</span><span class="n">LL</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span><span class="k">return</span> <span class="n">len</span> <span class="o">-</span> <span class="n">x</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">D</span><span class="p">,</span><span class="n">j</span> <span class="o">=</span> <span class="n">S</span><span class="p">;</span> <span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">/=</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">SA</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">stp</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">'a'</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">stp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">d</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">d</span><span class="o">*=</span><span class="mi">2</span><span class="p">,</span><span class="n">stp</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ind</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">)</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="n">d</span><span class="p">];</span>
            <span class="k">else</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">sort</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="o">+</span><span class="n">len</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">P</span><span class="p">[</span><span class="n">stp</span><span class="p">][</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ind</span> <span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span><span class="p">][</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">ind</span> <span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span><span class="p">][</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ind</span> <span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">stp</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>













<span class="cm">/** Suffix Array Faster **/</span>

<span class="k">struct</span> <span class="n">node</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">ind</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span> <span class="k">const</span> <span class="n">node</span><span class="o">&amp;</span> <span class="n">p</span> <span class="p">)</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="n">node</span> <span class="n">L</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">P</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="n">Max</span><span class="p">],</span><span class="n">D</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">len</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="n">LL</span> <span class="n">LCP</span><span class="p">(</span><span class="n">LL</span> <span class="n">x</span><span class="p">,</span><span class="n">LL</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span><span class="k">return</span> <span class="n">len</span> <span class="o">-</span> <span class="n">x</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">D</span><span class="p">,</span><span class="n">j</span> <span class="o">=</span> <span class="n">S</span><span class="p">;</span> <span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">/=</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">node</span> <span class="n">Lsrt</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">MX</span><span class="p">;</span>
<span class="n">LL</span> <span class="n">cnt</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">taken</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">spcl</span><span class="p">,</span><span class="n">spcltaken</span><span class="p">,</span><span class="n">sum</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="kt">void</span> <span class="n">Sort</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">idx</span><span class="p">,</span><span class="n">l</span><span class="p">;</span>

    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">my</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">my</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="n">spcl</span><span class="o">++</span><span class="p">;</span>
        <span class="k">else</span> <span class="n">cnt</span><span class="p">[</span><span class="n">my</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">sum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spcl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">MX</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">my</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">my</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">spcltaken</span><span class="o">++</span><span class="p">;</span>
            <span class="n">Lsrt</span><span class="p">[</span> <span class="n">spcltaken</span><span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">taken</span><span class="p">[</span><span class="n">my</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="n">Lsrt</span><span class="p">[</span> <span class="n">sum</span><span class="p">[</span><span class="n">my</span><span class="p">]</span> <span class="o">+</span> <span class="n">taken</span><span class="p">[</span><span class="n">my</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">spcl</span> <span class="o">=</span> <span class="n">spcltaken</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">MX</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">taken</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">my</span> <span class="o">=</span> <span class="n">Lsrt</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

        <span class="k">if</span><span class="p">(</span><span class="n">my</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="n">spcl</span><span class="o">++</span><span class="p">;</span>
        <span class="k">else</span> <span class="n">cnt</span><span class="p">[</span><span class="n">my</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">sum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spcl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">MX</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">my</span> <span class="o">=</span> <span class="n">Lsrt</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">my</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">spcltaken</span><span class="o">++</span><span class="p">;</span>
            <span class="n">L</span><span class="p">[</span> <span class="n">spcltaken</span><span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">Lsrt</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">taken</span><span class="p">[</span><span class="n">my</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="n">L</span><span class="p">[</span> <span class="n">sum</span><span class="p">[</span><span class="n">my</span><span class="p">]</span> <span class="o">+</span> <span class="n">taken</span><span class="p">[</span><span class="n">my</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">Lsrt</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">spcl</span> <span class="o">=</span> <span class="n">spcltaken</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">MX</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">taken</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">SA</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">stp</span><span class="p">;</span>
    <span class="n">MX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">'a'</span><span class="p">;</span>
        <span class="n">MX</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">MX</span><span class="p">,</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">stp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">d</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">d</span><span class="o">*=</span><span class="mi">2</span><span class="p">,</span><span class="n">stp</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ind</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">)</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="n">d</span><span class="p">];</span>
            <span class="k">else</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">Sort</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">P</span><span class="p">[</span><span class="n">stp</span><span class="p">][</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ind</span> <span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span><span class="p">][</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">ind</span> <span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="n">P</span><span class="p">[</span><span class="n">stp</span><span class="p">][</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ind</span> <span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">MX</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">MX</span><span class="p">,</span><span class="n">P</span><span class="p">[</span><span class="n">stp</span><span class="p">][</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ind</span> <span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">stp</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>















<span class="cm">/** Z - algo **/</span>

<span class="kt">void</span> <span class="n">zalgo</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">r</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">str</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="p">])</span><span class="n">r</span><span class="o">++</span><span class="p">;</span>
            <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">;</span>
            <span class="n">r</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">l</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">r</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">l</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                <span class="k">while</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">str</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="p">])</span><span class="n">r</span><span class="o">++</span><span class="p">;</span>
                <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">;</span>
                <span class="n">r</span><span class="o">--</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>










<span class="cm">/** iiSAT **/</span>

<span class="n">vector</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">ug</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">sc</span><span class="p">[</span><span class="n">Max</span><span class="p">],</span><span class="n">cg</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">visit</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="n">stack</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
<span class="n">LL</span> <span class="n">idx</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">codx</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>

<span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">,</span><span class="n">LL</span> <span class="n">f</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">len</span><span class="p">,</span><span class="n">i</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">f</span><span class="p">)</span><span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="k">else</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">ug</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">f</span><span class="p">)</span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">else</span> <span class="n">v</span> <span class="o">=</span> <span class="n">ug</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">f</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">f</span><span class="p">)</span><span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">sc</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
        <span class="n">codx</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">go</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">,</span><span class="n">LL</span> <span class="n">c</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span><span class="n">i</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">codx</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="n">c</span><span class="p">)</span><span class="n">cg</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">codx</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">buildGraph</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="n">sort</span><span class="p">(</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span><span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">());</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="n">go</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">///compress</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="n">sort</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">());</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">vector</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">tmp</span><span class="p">;</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">LL</span> <span class="n">prev</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">prev</span><span class="p">)</span><span class="n">tmp</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
        <span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span><span class="n">cg</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">ret</span><span class="p">;</span>
<span class="n">LL</span> <span class="n">slol</span><span class="p">[</span><span class="n">Max</span><span class="p">];</span>
<span class="kt">void</span> <span class="n">cdfs</span><span class="p">(</span><span class="n">LL</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span><span class="n">i</span><span class="p">;</span>
    <span class="n">Rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cg</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">cdfs</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">iiSAT</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">LL</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">codx</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span>  <span class="o">==</span> <span class="n">codx</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="n">cdfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="n">mem</span><span class="p">(</span><span class="n">slol</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">vector</span> <span class="o">&lt;</span><span class="n">LL</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
    <span class="n">v</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">v</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">());</span>
        <span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">LL</span> <span class="n">vlen</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">vlen</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LL</span> <span class="n">u</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">LL</span> <span class="n">len</span> <span class="o">=</span> <span class="n">sz</span><span class="p">(</span><span class="n">sc</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
        <span class="n">LL</span> <span class="n">my</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">sc</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="n">LL</span> <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">slol</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">slol</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">my</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">slol</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">my</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">Rep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">len</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">LL</span> <span class="n">v</span> <span class="o">=</span> <span class="n">sc</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="n">LL</span> <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span><span class="n">slol</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">my</span><span class="p">;</span>
            <span class="k">else</span> <span class="n">slol</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">my</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">/// (A or B)</span>
    <span class="c1">/// !A -&gt; B</span>
    <span class="c1">/// !B -&gt; A</span>
    <span class="c1">/// SCC</span>
    <span class="c1">/// compress</span>
    <span class="c1">/// call iiSAT</span>
    <span class="c1">/// if(A and !A == same)ret = 0;</span>
    <span class="c1">/// else slol gives the solution</span>
<span class="p">}</span>
</pre></div>
</td></tr></tbody></table>
</div>
<a class="pturl" href="http://paste.ubuntu.com/12127200/plain/">Download as text</a>
</div>




		    </div>
	    </div>
	</div>



</body></html>